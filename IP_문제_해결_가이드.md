# GPS Logger IP 문제 해결 가이드

## 문제 상황
- 9월 8일 18시 이후 GPS 데이터가 수집되지 않음
- OwnTracks 앱이 활성화되어 있었지만 데이터 전송 실패
- **추정 원인**: IPv4 주소 변경으로 인한 OwnTracks 앱 연결 실패

## 현재 상황 분석

### 1. 데이터베이스 현황
- 9월 8일 13:33 ~ 16:33까지의 데이터만 존재 (총 21개)
- 18시 이후 데이터: 0개
- 가장 최근 데이터: 2025-09-08T16:33:24+09:00

### 2. 서버 상태
- Flask 서버: 포트 5000에서 실행 중
- API 엔드포인트: 정상 작동
- 지도 표시: 정상 작동 (기존 데이터 기준)

## 해결 방안

### 🚨 즉시 해결 방안 (권장)
1. **OwnTracks 앱 설정 업데이트**
   - 앱에서 서버 URL을 `http://192.168.0.30:5000/owntracks`로 변경
   - 기존 설정이 다른 IP로 되어 있을 가능성 높음

2. **방화벽 규칙 추가**
   ```cmd
   netsh advfirewall firewall add rule name="GPS Logger" dir=in action=allow protocol=TCP localport=5000
   ```

### 방안 1: 고정 IP 설정 (장기적 해결)
- 라우터에서 DHCP 예약 설정 (192.168.0.30 고정)
- PC에서 고정 IP 설정

### 방안 2: DDNS (Dynamic DNS) 서비스
- 무료 DDNS 서비스 활용 (No-IP, DuckDNS 등)
- 도메인명으로 접근 가능

### 방안 3: 네트워크 설정 점검
- ✅ 포트 포워딩 확인 (라우터 설정 필요)
- ✅ 방화벽 설정 확인 (규칙 추가 필요)

## 진행 단계
1. ✅ 현재 IP 주소 확인: **192.168.0.30**
2. ✅ 네트워크 설정 점검: **서버 실행 중, 방화벽 규칙 추가됨**
3. ✅ 해결 방안 적용: **방화벽 규칙 추가 완료**
4. 🔄 OwnTracks 앱 설정 확인 필요
5. 테스트 및 검증

## 다음 단계
1. **OwnTracks 앱에서 서버 URL 확인/변경**
   - 현재 설정: `http://[이전IP]:5000/owntracks`
   - 변경할 URL: `http://192.168.0.30:5000/owntracks`

2. **테스트 방법**

### OwnTracks 앱에서 위치 전송 시도하는 방법

#### A. 앱 설정 변경
1. **OwnTracks 앱 열기**
2. **설정(Settings) 메뉴** 접근
3. **Connection** 또는 **연결** 섹션 찾기
4. **Host** 또는 **서버 주소**를 `192.168.0.30`으로 변경
5. **Port** 또는 **포트**를 `5000`으로 설정
6. **Path** 또는 **경로**를 `/owntracks`로 설정
7. **저장** 또는 **Save** 클릭

#### B. 수동 위치 전송
1. **앱 메인 화면**에서 **전송** 또는 **Send** 버튼 찾기
2. **현재 위치 전송** 또는 **Send Location** 클릭
3. **전송 성공/실패 메시지** 확인

#### C. 자동 전송 설정 확인
1. **설정** → **Mode** 또는 **모드** 확인
2. **Significant Changes** 또는 **중요한 변화** 모드 권장
3. **Interval** 또는 **간격** 설정 (예: 5분, 10분)
4. **Battery Optimization** 또는 **배터리 최적화** 해제

#### D. 전송 상태 확인
- **앱 내 로그** 또는 **Logs** 메뉴에서 전송 상태 확인
- **연결 상태** 표시 확인
- **마지막 전송 시간** 확인

#### E. 서버에서 데이터 확인
- 서버 로그 확인: `http://192.168.0.30:5000/last?n=5`
- 지도 확인: `http://192.168.0.30:5000/map2`

### 문제 해결 체크리스트

#### ✅ 설정 확인 사항
- [ ] OwnTracks 앱에서 서버 주소가 `192.168.0.30`으로 설정됨
- [ ] 포트가 `5000`으로 설정됨
- [ ] 경로가 `/owntracks`로 설정됨
- [ ] 앱이 GPS 권한을 가지고 있음
- [ ] 앱이 백그라운드에서 실행 가능하도록 설정됨

#### ✅ 네트워크 확인 사항
- [ ] PC와 스마트폰이 같은 Wi-Fi 네트워크에 연결됨
- [ ] 서버가 `http://192.168.0.30:5000`에서 접근 가능함
- [ ] 방화벽에서 포트 5000이 허용됨

#### ✅ 테스트 단계
1. [ ] 앱 설정 변경 후 **저장**
2. [ ] 앱에서 **수동 위치 전송** 시도
3. [ ] 전송 성공 메시지 확인
4. [ ] 서버에서 새 데이터 확인: `http://192.168.0.30:5000/last?n=5`
5. [ ] 지도에서 새 데이터 표시 확인: `http://192.168.0.30:5000/map2`

## 현재 확인된 정보
- **현재 내부 IP**: 192.168.0.30
- **서버 포트**: 5000
- **서버 URL**: http://192.168.0.30:5000
- **OwnTracks 엔드포인트**: http://192.168.0.30:5000/owntracks

---
*생성일: 2025-09-09*
*상태: 진행 중*

